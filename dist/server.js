/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 8);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/*!********************!*\
  !*** ../logger.js ***!
  \********************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__athena_app_fabric_logger__ = __webpack_require__(/*! @athena/app-fabric-logger */ 12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__athena_app_fabric_logger___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__athena_app_fabric_logger__);\n\n\nconst logger = new __WEBPACK_IMPORTED_MODULE_0__athena_app_fabric_logger___default.a({\n\tprettyPrint: true,\n\tcolorize: true,\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (logger);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi9sb2dnZXIuanM/MTA2YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTG9nZ2VyIGZyb20gJ0BhdGhlbmEvYXBwLWZhYnJpYy1sb2dnZXInO1xuXG5jb25zdCBsb2dnZXIgPSBuZXcgTG9nZ2VyKHtcblx0cHJldHR5UHJpbnQ6IHRydWUsXG5cdGNvbG9yaXplOiB0cnVlLFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGxvZ2dlcjtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4uL2xvZ2dlci5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/*!****************************!*\
  !*** external "sequelize" ***!
  \****************************/
/*! dynamic exports provided */
/*! exports used: default */
/***/ (function(module, exports) {

eval("module.exports = require(\"sequelize\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcInNlcXVlbGl6ZVwiPzVjZDUiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwic2VxdWVsaXplXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwic2VxdWVsaXplXCJcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImV4cHJlc3NcIj9kMmQyIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJleHByZXNzXCJcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/*!*******************!*\
  !*** ../db/db.js ***!
  \*******************/
/*! exports provided: db */
/*! exports used: db */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return db; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize__ = __webpack_require__(/*! sequelize */ 1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_sequelize__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__logger_js__ = __webpack_require__(/*! ../logger.js */ 0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__models_book_js__ = __webpack_require__(/*! ../models/book.js */ 13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__models_member_js__ = __webpack_require__(/*! ../models/member.js */ 4);\n\n\n\n\n\nconst db = {};\n\ndb.transaction = async (f, username) => {\n\tawait db.initializeDb();\n\tawait db.sequelize.transaction(f);\n};\n\nlet initialized = false;\ndb.initializeDb = async () => {\n\tif (!initialized) {\n\t\tlet connectionString = '';\n\t\tif (process.env.NODE_ENV === 'test') {\n\t\t\t__WEBPACK_IMPORTED_MODULE_1__logger_js__[\"a\" /* default */].info('Connecting to test database.');\n\t\t\tconnectionString = 'postgres://nvaithyanathan:lkas1234QQ@localhost:5432/library_test';\n\t\t}\n\t\telse {\n\t\t\tconnectionString = 'postgres://nvaithyanathan:lkas1234QQ@localhost:5432/library';\n\t\t}\n\n\t\tconst sequelize = new __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a(connectionString, {\n\t\t\tlogging: false,\n\t\t\tquery: {\n\t\t\t\traw: true,\n\t\t\t},\n\t\t});\n\t\tdb.member = Object(__WEBPACK_IMPORTED_MODULE_3__models_member_js__[\"a\" /* default */])(sequelize);\n\t\tdb.book = Object(__WEBPACK_IMPORTED_MODULE_2__models_book_js__[\"a\" /* default */])(sequelize);\n\t\tdb.sequelize = sequelize;\n\t\tinitialized = true;\n\t}\n};\n\ndb.syncSchema = async (force = false) => {\n\ttry {\n\t\tconst params = { force };\t\n\t\tawait db.initializeDb();\n\t\tawait db.member.sync(params);\n\t\tawait db.book.sync(params);\n\t}\n\tcatch (e) {\n\t\t__WEBPACK_IMPORTED_MODULE_1__logger_js__[\"a\" /* default */].error(e);\n\t}\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi9kYi9kYi5qcz9jYjNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTZXF1ZWxpemUgZnJvbSAnc2VxdWVsaXplJztcbmltcG9ydCBsb2dnZXIgZnJvbSAnLi4vbG9nZ2VyLmpzJztcbmltcG9ydCBib29rTW9kZWwgZnJvbSAnLi4vbW9kZWxzL2Jvb2suanMnO1xuaW1wb3J0IG1lbWJlck1vZGVsIGZyb20gJy4uL21vZGVscy9tZW1iZXIuanMnO1xuXG5jb25zdCBkYiA9IHt9O1xuXG5kYi50cmFuc2FjdGlvbiA9IGFzeW5jIChmLCB1c2VybmFtZSkgPT4ge1xuXHRhd2FpdCBkYi5pbml0aWFsaXplRGIoKTtcblx0YXdhaXQgZGIuc2VxdWVsaXplLnRyYW5zYWN0aW9uKGYpO1xufTtcblxubGV0IGluaXRpYWxpemVkID0gZmFsc2U7XG5kYi5pbml0aWFsaXplRGIgPSBhc3luYyAoKSA9PiB7XG5cdGlmICghaW5pdGlhbGl6ZWQpIHtcblx0XHRsZXQgY29ubmVjdGlvblN0cmluZyA9ICcnO1xuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnKSB7XG5cdFx0XHRsb2dnZXIuaW5mbygnQ29ubmVjdGluZyB0byB0ZXN0IGRhdGFiYXNlLicpO1xuXHRcdFx0Y29ubmVjdGlvblN0cmluZyA9ICdwb3N0Z3JlczovL252YWl0aHlhbmF0aGFuOmxrYXMxMjM0UVFAbG9jYWxob3N0OjU0MzIvbGlicmFyeV90ZXN0Jztcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRjb25uZWN0aW9uU3RyaW5nID0gJ3Bvc3RncmVzOi8vbnZhaXRoeWFuYXRoYW46bGthczEyMzRRUUBsb2NhbGhvc3Q6NTQzMi9saWJyYXJ5Jztcblx0XHR9XG5cblx0XHRjb25zdCBzZXF1ZWxpemUgPSBuZXcgU2VxdWVsaXplKGNvbm5lY3Rpb25TdHJpbmcsIHtcblx0XHRcdGxvZ2dpbmc6IGZhbHNlLFxuXHRcdFx0cXVlcnk6IHtcblx0XHRcdFx0cmF3OiB0cnVlLFxuXHRcdFx0fSxcblx0XHR9KTtcblx0XHRkYi5tZW1iZXIgPSBtZW1iZXJNb2RlbChzZXF1ZWxpemUpO1xuXHRcdGRiLmJvb2sgPSBib29rTW9kZWwoc2VxdWVsaXplKTtcblx0XHRkYi5zZXF1ZWxpemUgPSBzZXF1ZWxpemU7XG5cdFx0aW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHR9XG59O1xuXG5kYi5zeW5jU2NoZW1hID0gYXN5bmMgKGZvcmNlID0gZmFsc2UpID0+IHtcblx0dHJ5IHtcblx0XHRjb25zdCBwYXJhbXMgPSB7IGZvcmNlIH07XHRcblx0XHRhd2FpdCBkYi5pbml0aWFsaXplRGIoKTtcblx0XHRhd2FpdCBkYi5tZW1iZXIuc3luYyhwYXJhbXMpO1xuXHRcdGF3YWl0IGRiLmJvb2suc3luYyhwYXJhbXMpO1xuXHR9XG5cdGNhdGNoIChlKSB7XG5cdFx0bG9nZ2VyLmVycm9yKGUpO1xuXHR9XG59O1xuXG5leHBvcnQgeyBkYiB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi4vZGIvZGIuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/*!***************************!*\
  !*** ../models/member.js ***!
  \***************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize__ = __webpack_require__(/*! sequelize */ 1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_sequelize__);\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ((sequelizeInstance) => sequelizeInstance.define('member', {\n    username: {\n        field: 'username',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.STRING(20),\n        notNull: true\n    },\n    noOfBooksTaken: {\n        field: 'noofbookstaken',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.INTEGER,\n        notNull: true,\n        defaultValue: 0\n    },\n    contactNumber: {\n        field: 'contactnumber',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.STRING(10)\n    },\n    amountDue: {\n        field: 'amountdue',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.FLOAT,\n        notNull: true,\n        defaultValue: 0\n    },\n    joinedOn: {\n        field: 'joinedon',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.DATE,\n        notNull: true,\n        defaultValue: function () {\n            const date = new Date();\n            return date.getDate();\n        }\n    },\n    unRegisteredYN: {\n        field: 'unregisteredyn',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.BOOLEAN,\n        defaultValue: false\n    }   \n}));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi9tb2RlbHMvbWVtYmVyLmpzPzE5MmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNlcXVlbGl6ZSBmcm9tICdzZXF1ZWxpemUnO1xuXG5leHBvcnQgZGVmYXVsdCAoc2VxdWVsaXplSW5zdGFuY2UpID0+IHNlcXVlbGl6ZUluc3RhbmNlLmRlZmluZSgnbWVtYmVyJywge1xuICAgIHVzZXJuYW1lOiB7XG4gICAgICAgIGZpZWxkOiAndXNlcm5hbWUnLFxuICAgICAgICB0eXBlOiBTZXF1ZWxpemUuU1RSSU5HKDIwKSxcbiAgICAgICAgbm90TnVsbDogdHJ1ZVxuICAgIH0sXG4gICAgbm9PZkJvb2tzVGFrZW46IHtcbiAgICAgICAgZmllbGQ6ICdub29mYm9va3N0YWtlbicsXG4gICAgICAgIHR5cGU6IFNlcXVlbGl6ZS5JTlRFR0VSLFxuICAgICAgICBub3ROdWxsOiB0cnVlLFxuICAgICAgICBkZWZhdWx0VmFsdWU6IDBcbiAgICB9LFxuICAgIGNvbnRhY3ROdW1iZXI6IHtcbiAgICAgICAgZmllbGQ6ICdjb250YWN0bnVtYmVyJyxcbiAgICAgICAgdHlwZTogU2VxdWVsaXplLlNUUklORygxMClcbiAgICB9LFxuICAgIGFtb3VudER1ZToge1xuICAgICAgICBmaWVsZDogJ2Ftb3VudGR1ZScsXG4gICAgICAgIHR5cGU6IFNlcXVlbGl6ZS5GTE9BVCxcbiAgICAgICAgbm90TnVsbDogdHJ1ZSxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiAwXG4gICAgfSxcbiAgICBqb2luZWRPbjoge1xuICAgICAgICBmaWVsZDogJ2pvaW5lZG9uJyxcbiAgICAgICAgdHlwZTogU2VxdWVsaXplLkRBVEUsXG4gICAgICAgIG5vdE51bGw6IHRydWUsXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS5nZXREYXRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHVuUmVnaXN0ZXJlZFlOOiB7XG4gICAgICAgIGZpZWxkOiAndW5yZWdpc3RlcmVkeW4nLFxuICAgICAgICB0eXBlOiBTZXF1ZWxpemUuQk9PTEVBTixcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBmYWxzZVxuICAgIH0gICBcbn0pO1xuXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuLi9tb2RlbHMvbWVtYmVyLmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///4\n");

/***/ }),
/* 5 */
/*!*********************************!*\
  !*** ../middleware/handlers.js ***!
  \*********************************/
/*! exports provided: requestHandler */
/*! exports used: requestHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__logger_js__ = __webpack_require__(/*! ../logger.js */ 0);\n\n\nconst requestHandler = async (req, res, requestHandlerFunction) => {\n   \n    let result = {};\n\n    try {\n\n        result = await requestHandlerFunction(req);\n\n    }\n    catch (error) {\n       \n        __WEBPACK_IMPORTED_MODULE_0__logger_js__[\"a\" /* default */].error(error);\n       \n        result.status = 500;\n        result.result = 'Unable to process your request.'\n\n        if (error) {\n            result.error = error.toString();\n        }\n        \n    }\n   \n    let jsonToReturn = {};\n\n    if (result.json) {\n        jsonToReturn = result.json;\n    }\n    else {\n        jsonToReturn = {\n            result: result.result,\n        };\n\n        if (result.error) {\n            jsonToReturn.error = result.error;\n        }\n    }\n    \n    res.status(result.status).json(jsonToReturn);\n\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = requestHandler;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi9taWRkbGV3YXJlL2hhbmRsZXJzLmpzPzRjN2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGxvZ2dlciBmcm9tICcuLi9sb2dnZXIuanMnO1xuXG5leHBvcnQgY29uc3QgcmVxdWVzdEhhbmRsZXIgPSBhc3luYyAocmVxLCByZXMsIHJlcXVlc3RIYW5kbGVyRnVuY3Rpb24pID0+IHtcbiAgIFxuICAgIGxldCByZXN1bHQgPSB7fTtcblxuICAgIHRyeSB7XG5cbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgcmVxdWVzdEhhbmRsZXJGdW5jdGlvbihyZXEpO1xuXG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgIFxuICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgIFxuICAgICAgICByZXN1bHQuc3RhdHVzID0gNTAwO1xuICAgICAgICByZXN1bHQucmVzdWx0ID0gJ1VuYWJsZSB0byBwcm9jZXNzIHlvdXIgcmVxdWVzdC4nXG5cbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICByZXN1bHQuZXJyb3IgPSBlcnJvci50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbiAgIFxuICAgIGxldCBqc29uVG9SZXR1cm4gPSB7fTtcblxuICAgIGlmIChyZXN1bHQuanNvbikge1xuICAgICAgICBqc29uVG9SZXR1cm4gPSByZXN1bHQuanNvbjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGpzb25Ub1JldHVybiA9IHtcbiAgICAgICAgICAgIHJlc3VsdDogcmVzdWx0LnJlc3VsdCxcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICBqc29uVG9SZXR1cm4uZXJyb3IgPSByZXN1bHQuZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmVzLnN0YXR1cyhyZXN1bHQuc3RhdHVzKS5qc29uKGpzb25Ub1JldHVybik7XG5cbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4uL21pZGRsZXdhcmUvaGFuZGxlcnMuanNcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///5\n");

/***/ }),
/* 6 */
/*!************************************!*\
  !*** external "http-status-codes" ***!
  \************************************/
/*! dynamic exports provided */
/*! exports used: default */
/***/ (function(module, exports) {

eval("module.exports = require(\"http-status-codes\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImh0dHAtc3RhdHVzLWNvZGVzXCI/MjQ2MyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJodHRwLXN0YXR1cy1jb2Rlc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImh0dHAtc3RhdHVzLWNvZGVzXCJcbi8vIG1vZHVsZSBpZCA9IDZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///6\n");

/***/ }),
/* 7 */
/*!************************!*\
  !*** ../utils/util.js ***!
  \************************/
/*! exports provided: validateMember, validateBook */
/*! exports used: validateBook, validateMember */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_validator__ = __webpack_require__(/*! validator */ 16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_validator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_validator__);\n\n\nconst validateMember = (username, contactNumber) => {\n\n    if(username === '' || typeof(username) === 'number') {\n        throw new Error('Username cannot be empty and it should be a string containing atleast one character.')\n    }\n\n    if (!__WEBPACK_IMPORTED_MODULE_0_validator___default.a.matches(username, /[a-zA-Z0-9]{6,12}/i)) {\n        throw new Error('Username should be between 6-12 characters/digits. Cannot contain special characters. Should be a string.');\n    }\n\n    if (typeof(contactNumber) === 'number') {\n        throw new Error('Contact number should be a string.');\n    }\n\n    if (contactNumber && !__WEBPACK_IMPORTED_MODULE_0_validator___default.a.isNumeric(contactNumber)) {\n        throw new Error('Contact number can contain only numbers.')\n    }\n\n}\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = validateMember;\n\n\nconst validateBook = (name, author, edition, publishedDate, shelfNumber) => {\n\n    if (!typeof(name) === 'string' || name === '') {\n        throw new Error('Name of the book cannot be empty and should be a string.');\n    }\n   \n    if (!typeof(author) === 'string' || author === '') {\n        throw new Error('Author of the book cannot be empty and should be a string.');\n    }\n\n    if (!typeof(shelfNumber) === 'string' || shelfNumber === '') {\n        throw new Error('Shelf number of the book cannot be empty and should be a string.');\n    }\n\n    if (!__WEBPACK_IMPORTED_MODULE_0_validator___default.a.matches(name, /[a-zA-Z0-9]{6,20}/i)) {\n        throw new Error('Name of the book has to contain between 6 and 20 characters and it cannot contain special characters.');\n    }\n\n    if(publishedDate && !publishedDate.match(/[0-9]{2}\\/[0-9]{2}\\/[1,2][7,8,9,0][0-9]{2}/)) {\n        throw new Error('Published date of the book is not valid.');\n    }\n\n    if (edition && !__WEBPACK_IMPORTED_MODULE_0_validator___default.a.isInt(edition)) {\n        throw new Error('Edition number of the book is not valid. It has to be a number.');\n    }\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = validateBook;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi91dGlscy91dGlsLmpzPzZiMDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHZhbGlkYXRvciBmcm9tICd2YWxpZGF0b3InO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGVNZW1iZXIgPSAodXNlcm5hbWUsIGNvbnRhY3ROdW1iZXIpID0+IHtcblxuICAgIGlmKHVzZXJuYW1lID09PSAnJyB8fCB0eXBlb2YodXNlcm5hbWUpID09PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXJuYW1lIGNhbm5vdCBiZSBlbXB0eSBhbmQgaXQgc2hvdWxkIGJlIGEgc3RyaW5nIGNvbnRhaW5pbmcgYXRsZWFzdCBvbmUgY2hhcmFjdGVyLicpXG4gICAgfVxuXG4gICAgaWYgKCF2YWxpZGF0b3IubWF0Y2hlcyh1c2VybmFtZSwgL1thLXpBLVowLTldezYsMTJ9L2kpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVXNlcm5hbWUgc2hvdWxkIGJlIGJldHdlZW4gNi0xMiBjaGFyYWN0ZXJzL2RpZ2l0cy4gQ2Fubm90IGNvbnRhaW4gc3BlY2lhbCBjaGFyYWN0ZXJzLiBTaG91bGQgYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZihjb250YWN0TnVtYmVyKSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb250YWN0IG51bWJlciBzaG91bGQgYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbnRhY3ROdW1iZXIgJiYgIXZhbGlkYXRvci5pc051bWVyaWMoY29udGFjdE51bWJlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb250YWN0IG51bWJlciBjYW4gY29udGFpbiBvbmx5IG51bWJlcnMuJylcbiAgICB9XG5cbn1cblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlQm9vayA9IChuYW1lLCBhdXRob3IsIGVkaXRpb24sIHB1Ymxpc2hlZERhdGUsIHNoZWxmTnVtYmVyKSA9PiB7XG5cbiAgICBpZiAoIXR5cGVvZihuYW1lKSA9PT0gJ3N0cmluZycgfHwgbmFtZSA9PT0gJycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOYW1lIG9mIHRoZSBib29rIGNhbm5vdCBiZSBlbXB0eSBhbmQgc2hvdWxkIGJlIGEgc3RyaW5nLicpO1xuICAgIH1cbiAgIFxuICAgIGlmICghdHlwZW9mKGF1dGhvcikgPT09ICdzdHJpbmcnIHx8IGF1dGhvciA9PT0gJycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdXRob3Igb2YgdGhlIGJvb2sgY2Fubm90IGJlIGVtcHR5IGFuZCBzaG91bGQgYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0eXBlb2Yoc2hlbGZOdW1iZXIpID09PSAnc3RyaW5nJyB8fCBzaGVsZk51bWJlciA9PT0gJycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaGVsZiBudW1iZXIgb2YgdGhlIGJvb2sgY2Fubm90IGJlIGVtcHR5IGFuZCBzaG91bGQgYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxuXG4gICAgaWYgKCF2YWxpZGF0b3IubWF0Y2hlcyhuYW1lLCAvW2EtekEtWjAtOV17NiwyMH0vaSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOYW1lIG9mIHRoZSBib29rIGhhcyB0byBjb250YWluIGJldHdlZW4gNiBhbmQgMjAgY2hhcmFjdGVycyBhbmQgaXQgY2Fubm90IGNvbnRhaW4gc3BlY2lhbCBjaGFyYWN0ZXJzLicpO1xuICAgIH1cblxuICAgIGlmKHB1Ymxpc2hlZERhdGUgJiYgIXB1Ymxpc2hlZERhdGUubWF0Y2goL1swLTldezJ9XFwvWzAtOV17Mn1cXC9bMSwyXVs3LDgsOSwwXVswLTldezJ9LykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQdWJsaXNoZWQgZGF0ZSBvZiB0aGUgYm9vayBpcyBub3QgdmFsaWQuJyk7XG4gICAgfVxuXG4gICAgaWYgKGVkaXRpb24gJiYgIXZhbGlkYXRvci5pc0ludChlZGl0aW9uKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VkaXRpb24gbnVtYmVyIG9mIHRoZSBib29rIGlzIG5vdCB2YWxpZC4gSXQgaGFzIHRvIGJlIGEgbnVtYmVyLicpO1xuICAgIH1cbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuLi91dGlscy91dGlsLmpzXG4vLyBtb2R1bGUgaWQgPSA3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///7\n");

/***/ }),
/* 8 */
/*!****************************************!*\
  !*** multi babel-polyfill ./server.js ***!
  \****************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! babel-polyfill */9);
module.exports = __webpack_require__(/*! ./server.js */10);


/***/ }),
/* 9 */
/*!*********************************!*\
  !*** external "babel-polyfill" ***!
  \*********************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports) {

eval("module.exports = require(\"babel-polyfill\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImJhYmVsLXBvbHlmaWxsXCI/ZDBkNiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJiYWJlbC1wb2x5ZmlsbFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJhYmVsLXBvbHlmaWxsXCJcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///9\n");

/***/ }),
/* 10 */
/*!*******************!*\
  !*** ./server.js ***!
  \*******************/
/*! no exports provided */
/*! all exports used */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__logger_js__ = __webpack_require__(/*! ../logger.js */ 0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__db_db_js__ = __webpack_require__(/*! ../db/db.js */ 3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__controllers_bookController_js__ = __webpack_require__(/*! ../controllers/bookController.js */ 14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__controllers_memberController_js__ = __webpack_require__(/*! ../controllers/memberController.js */ 17);\nconst express = __webpack_require__(/*! express */ 2);\r\nconst bodyParser = __webpack_require__(/*! body-parser */ 11);\r\n\r\n\r\n\r\n\r\n\r\nconst app = express();\r\nconst port = 8080;\r\n\r\napp.use((req, res, next) => {\r\n  __WEBPACK_IMPORTED_MODULE_0__logger_js__[\"a\" /* default */].info(`Incoming request.`);\r\n  next();\r\n});\r\n\r\napp.use(bodyParser.json());\r\n\r\napp.use('/api', Object(__WEBPACK_IMPORTED_MODULE_2__controllers_bookController_js__[\"a\" /* bookRouter */])());\r\napp.use('/api', Object(__WEBPACK_IMPORTED_MODULE_3__controllers_memberController_js__[\"a\" /* memberRouter */])());\r\n\r\napp.listen(port, () => {\r\n  __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].syncSchema();\r\n  console.log(`Server is running on port ${port}.`);\r\n})\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zZXJ2ZXIuanM/N2FhMiJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcclxuaW1wb3J0IGxvZ2dlciBmcm9tICcuLi9sb2dnZXIuanMnO1xyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uL2RiL2RiLmpzJ1xyXG5pbXBvcnQgeyBib29rUm91dGVyIH0gZnJvbSAnLi4vY29udHJvbGxlcnMvYm9va0NvbnRyb2xsZXIuanMnO1xyXG5pbXBvcnQgeyBtZW1iZXJSb3V0ZXIgfSBmcm9tICcuLi9jb250cm9sbGVycy9tZW1iZXJDb250cm9sbGVyLmpzJztcclxuXHJcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuY29uc3QgcG9ydCA9IDgwODA7XHJcblxyXG5hcHAudXNlKChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGxvZ2dlci5pbmZvKGBJbmNvbWluZyByZXF1ZXN0LmApO1xyXG4gIG5leHQoKTtcclxufSk7XHJcblxyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcclxuXHJcbmFwcC51c2UoJy9hcGknLCBib29rUm91dGVyKCkpO1xyXG5hcHAudXNlKCcvYXBpJywgbWVtYmVyUm91dGVyKCkpO1xyXG5cclxuYXBwLmxpc3Rlbihwb3J0LCAoKSA9PiB7XHJcbiAgZGIuc3luY1NjaGVtYSgpO1xyXG4gIGNvbnNvbGUubG9nKGBTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0ICR7cG9ydH0uYCk7XHJcbn0pXHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc2VydmVyLmpzXG4vLyBtb2R1bGUgaWQgPSAxMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///10\n");

/***/ }),
/* 11 */
/*!******************************!*\
  !*** external "body-parser" ***!
  \******************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports) {

eval("module.exports = require(\"body-parser\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiPzQ2NTciXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYm9keS1wYXJzZXJcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///11\n");

/***/ }),
/* 12 */
/*!********************************************!*\
  !*** external "@athena/app-fabric-logger" ***!
  \********************************************/
/*! dynamic exports provided */
/*! exports used: default */
/***/ (function(module, exports) {

eval("module.exports = require(\"@athena/app-fabric-logger\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJAYXRoZW5hL2FwcC1mYWJyaWMtbG9nZ2VyXCI/YjRkYiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJAYXRoZW5hL2FwcC1mYWJyaWMtbG9nZ2VyXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiQGF0aGVuYS9hcHAtZmFicmljLWxvZ2dlclwiXG4vLyBtb2R1bGUgaWQgPSAxMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///12\n");

/***/ }),
/* 13 */
/*!*************************!*\
  !*** ../models/book.js ***!
  \*************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize__ = __webpack_require__(/*! sequelize */ 1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_sequelize__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__member_js__ = __webpack_require__(/*! ./member.js */ 4);\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ((sequelizeInstance) => sequelizeInstance.define('book', {\n    name: {\n        field: 'name',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.STRING(20),\n        notNull: true\n    },\n    author: {\n        field: 'author',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.STRING(20),\n        notNull: true\n    },\n    publishedDate: {\n        field: 'publisheddate',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.DATE\n    },\n    edition: {\n        field: 'edition',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.STRING(2)\n    },\n    shelfNumber: {\n        field: 'shelfnumber',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.STRING(2),\n        notNull: true\n    },\n    deleted: {\n        field: 'deleted',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.BOOLEAN,\n        notNull: true,\n        defaultValue: false\n    },\n    noOfBooksAvailable: {\n        field: 'noofbooksavailable',\n        type: __WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.INTEGER,\n        notNull: true\n    }\n}, {\n    hooks: {\n        beforeValidate: function (bookInstance) {\n            console.log('Check what changed instead of updating all the fields passed in.');\n            // console.log(bookInstance.changed());\n            if (1) {\n                // console.log('Skipping update because nothing has changed.');\n                return true;\n            }\n        }\n    }\n}));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbW9kZWxzL2Jvb2suanM/MTYyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU2VxdWVsaXplIGZyb20gJ3NlcXVlbGl6ZSc7XG5pbXBvcnQgbWVtYmVyIGZyb20gJy4vbWVtYmVyLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgKHNlcXVlbGl6ZUluc3RhbmNlKSA9PiBzZXF1ZWxpemVJbnN0YW5jZS5kZWZpbmUoJ2Jvb2snLCB7XG4gICAgbmFtZToge1xuICAgICAgICBmaWVsZDogJ25hbWUnLFxuICAgICAgICB0eXBlOiBTZXF1ZWxpemUuU1RSSU5HKDIwKSxcbiAgICAgICAgbm90TnVsbDogdHJ1ZVxuICAgIH0sXG4gICAgYXV0aG9yOiB7XG4gICAgICAgIGZpZWxkOiAnYXV0aG9yJyxcbiAgICAgICAgdHlwZTogU2VxdWVsaXplLlNUUklORygyMCksXG4gICAgICAgIG5vdE51bGw6IHRydWVcbiAgICB9LFxuICAgIHB1Ymxpc2hlZERhdGU6IHtcbiAgICAgICAgZmllbGQ6ICdwdWJsaXNoZWRkYXRlJyxcbiAgICAgICAgdHlwZTogU2VxdWVsaXplLkRBVEVcbiAgICB9LFxuICAgIGVkaXRpb246IHtcbiAgICAgICAgZmllbGQ6ICdlZGl0aW9uJyxcbiAgICAgICAgdHlwZTogU2VxdWVsaXplLlNUUklORygyKVxuICAgIH0sXG4gICAgc2hlbGZOdW1iZXI6IHtcbiAgICAgICAgZmllbGQ6ICdzaGVsZm51bWJlcicsXG4gICAgICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcoMiksXG4gICAgICAgIG5vdE51bGw6IHRydWVcbiAgICB9LFxuICAgIGRlbGV0ZWQ6IHtcbiAgICAgICAgZmllbGQ6ICdkZWxldGVkJyxcbiAgICAgICAgdHlwZTogU2VxdWVsaXplLkJPT0xFQU4sXG4gICAgICAgIG5vdE51bGw6IHRydWUsXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZmFsc2VcbiAgICB9LFxuICAgIG5vT2ZCb29rc0F2YWlsYWJsZToge1xuICAgICAgICBmaWVsZDogJ25vb2Zib29rc2F2YWlsYWJsZScsXG4gICAgICAgIHR5cGU6IFNlcXVlbGl6ZS5JTlRFR0VSLFxuICAgICAgICBub3ROdWxsOiB0cnVlXG4gICAgfVxufSwge1xuICAgIGhvb2tzOiB7XG4gICAgICAgIGJlZm9yZVZhbGlkYXRlOiBmdW5jdGlvbiAoYm9va0luc3RhbmNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ2hlY2sgd2hhdCBjaGFuZ2VkIGluc3RlYWQgb2YgdXBkYXRpbmcgYWxsIHRoZSBmaWVsZHMgcGFzc2VkIGluLicpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYm9va0luc3RhbmNlLmNoYW5nZWQoKSk7XG4gICAgICAgICAgICBpZiAoMSkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdTa2lwcGluZyB1cGRhdGUgYmVjYXVzZSBub3RoaW5nIGhhcyBjaGFuZ2VkLicpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4uL21vZGVscy9ib29rLmpzXG4vLyBtb2R1bGUgaWQgPSAxM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///13\n");

/***/ }),
/* 14 */
/*!****************************************!*\
  !*** ../controllers/bookController.js ***!
  \****************************************/
/*! exports provided: bookRouter */
/*! exports used: bookRouter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_express__ = __webpack_require__(/*! express */ 2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_express___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_express__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__ = __webpack_require__(/*! ../middleware/handlers.js */ 5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__logic_book_js__ = __webpack_require__(/*! ../logic/book.js */ 15);\n\n\n\n\nconst bookRouter = () => {\n\n    const bookRouter = __WEBPACK_IMPORTED_MODULE_0_express___default.a.Router();\n    // Have a single handler for POST, pass type = 'CREATE' or 'BORROW' etc to redirect to correct function.\n    bookRouter.post   ('/books',                  async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].addBook));\n    bookRouter.get    ('/books',                  async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].getAllBooks));\n    bookRouter.get    ('/books/:id',              async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].getBook));\n    bookRouter.get    ('/books/availability/:id', async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].getBookAvailability));\n    bookRouter.patch  ('/books/:id',              async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].updateBook));\n    bookRouter.post   ('/books/borrow',           async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].borrowBook));\n    bookRouter.post   ('/books/return',           async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].returnBook));\n    bookRouter.delete ('/books/:id',              async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_book_js__[\"a\" /* default */].deleteBook));\n    // Don't use verbs in the route.\n    return bookRouter;\n};\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = bookRouter;\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vY29udHJvbGxlcnMvYm9va0NvbnRyb2xsZXIuanM/ZTcwNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCB7IHJlcXVlc3RIYW5kbGVyIH0gZnJvbSAnLi4vbWlkZGxld2FyZS9oYW5kbGVycy5qcyc7XG5pbXBvcnQgQm9va0Z1bmN0aW9ucyBmcm9tICcuLi9sb2dpYy9ib29rLmpzJztcblxuZXhwb3J0IGNvbnN0IGJvb2tSb3V0ZXIgPSAoKSA9PiB7XG5cbiAgICBjb25zdCBib29rUm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbiAgICAvLyBIYXZlIGEgc2luZ2xlIGhhbmRsZXIgZm9yIFBPU1QsIHBhc3MgdHlwZSA9ICdDUkVBVEUnIG9yICdCT1JST1cnIGV0YyB0byByZWRpcmVjdCB0byBjb3JyZWN0IGZ1bmN0aW9uLlxuICAgIGJvb2tSb3V0ZXIucG9zdCAgICgnL2Jvb2tzJywgICAgICAgICAgICAgICAgICBhc3luYyAocmVxLCByZXMpID0+IHJlcXVlc3RIYW5kbGVyKHJlcSwgcmVzLCBCb29rRnVuY3Rpb25zLmFkZEJvb2spKTtcbiAgICBib29rUm91dGVyLmdldCAgICAoJy9ib29rcycsICAgICAgICAgICAgICAgICAgYXN5bmMgKHJlcSwgcmVzKSA9PiByZXF1ZXN0SGFuZGxlcihyZXEsIHJlcywgQm9va0Z1bmN0aW9ucy5nZXRBbGxCb29rcykpO1xuICAgIGJvb2tSb3V0ZXIuZ2V0ICAgICgnL2Jvb2tzLzppZCcsICAgICAgICAgICAgICBhc3luYyAocmVxLCByZXMpID0+IHJlcXVlc3RIYW5kbGVyKHJlcSwgcmVzLCBCb29rRnVuY3Rpb25zLmdldEJvb2spKTtcbiAgICBib29rUm91dGVyLmdldCAgICAoJy9ib29rcy9hdmFpbGFiaWxpdHkvOmlkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiByZXF1ZXN0SGFuZGxlcihyZXEsIHJlcywgQm9va0Z1bmN0aW9ucy5nZXRCb29rQXZhaWxhYmlsaXR5KSk7XG4gICAgYm9va1JvdXRlci5wYXRjaCAgKCcvYm9va3MvOmlkJywgICAgICAgICAgICAgIGFzeW5jIChyZXEsIHJlcykgPT4gcmVxdWVzdEhhbmRsZXIocmVxLCByZXMsIEJvb2tGdW5jdGlvbnMudXBkYXRlQm9vaykpO1xuICAgIGJvb2tSb3V0ZXIucG9zdCAgICgnL2Jvb2tzL2JvcnJvdycsICAgICAgICAgICBhc3luYyAocmVxLCByZXMpID0+IHJlcXVlc3RIYW5kbGVyKHJlcSwgcmVzLCBCb29rRnVuY3Rpb25zLmJvcnJvd0Jvb2spKTtcbiAgICBib29rUm91dGVyLnBvc3QgICAoJy9ib29rcy9yZXR1cm4nLCAgICAgICAgICAgYXN5bmMgKHJlcSwgcmVzKSA9PiByZXF1ZXN0SGFuZGxlcihyZXEsIHJlcywgQm9va0Z1bmN0aW9ucy5yZXR1cm5Cb29rKSk7XG4gICAgYm9va1JvdXRlci5kZWxldGUgKCcvYm9va3MvOmlkJywgICAgICAgICAgICAgIGFzeW5jIChyZXEsIHJlcykgPT4gcmVxdWVzdEhhbmRsZXIocmVxLCByZXMsIEJvb2tGdW5jdGlvbnMuZGVsZXRlQm9vaykpO1xuICAgIC8vIERvbid0IHVzZSB2ZXJicyBpbiB0aGUgcm91dGUuXG4gICAgcmV0dXJuIGJvb2tSb3V0ZXI7XG59O1xuXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuLi9jb250cm9sbGVycy9ib29rQ29udHJvbGxlci5qc1xuLy8gbW9kdWxlIGlkID0gMTRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///14\n");

/***/ }),
/* 15 */
/*!************************!*\
  !*** ../logic/book.js ***!
  \************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize__ = __webpack_require__(/*! sequelize */ 1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_sequelize__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__db_db_js__ = __webpack_require__(/*! ../db/db.js */ 3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__logger_js__ = __webpack_require__(/*! ../logger.js */ 0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_http_status_codes__ = __webpack_require__(/*! http-status-codes */ 6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_http_status_codes__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_util_js__ = __webpack_require__(/*! ../utils/util.js */ 7);\n\n\n\n\n\n\nclass Book {\n\n    constructor () {\n        // Need 'this' to be defined to access checkBookAvailability within borrowBook.\n        // All methods were static previously, but 'this' was undefined inside those methods when the methods were passed as arguments to the handler.\n\n        this.borrowBook = this.borrowBook.bind(this);\n        this.checkBookAvailability = this.checkBookAvailability.bind(this);\n    }\n\n    async addBook (req) {\n        \n        const { name = '', author = '', edition = '', publishedDate = '', shelfNumber = '' } = req.body;\n        let createdBook;\n        let existingBook;\n\n        Object(__WEBPACK_IMPORTED_MODULE_4__utils_util_js__[\"a\" /* validateBook */])(name, author, edition, publishedDate, shelfNumber);\n        \n        try {\n\n            existingBook = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findAll({\n                where: {\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true },\n                    name,\n                    author,\n                    edition\n                }\n            });\n\n            if (existingBook.length === 0) {\n                createdBook = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.create({\n                    name,\n                    author,\n                    edition,\n                    shelfNumber,\n                    publishedDate,\n                    noOfBooksAvailable: 1\n                });\n\n            }\n            else {\n\n                await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.update({\n                    noOfBooksAvailable: existingBook[0].noOfBooksAvailable + 1\n                }, {\n                    where: {\n                        id: existingBook[0].id\n                    }\n                });\n\n                createdBook = existingBook[0];\n                createdBook.noOfBooksAvailable += 1;\n            }\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.CREATED,\n                result: 'This book has been added to our library.'\n            };\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to create books at the moment.',\n                error\n            }\n\n        }\n    }\n\n    async getAllBooks (req) {\n\n        let allBooks;\n        try {\n\n            allBooks = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findAll({\n                where: {\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                json: allBooks\n            }\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to fetch books at the moment.',\n                error\n            }\n\n        }\n    }\n\n    async getBook (req) {\n\n        let book;\n        try {\n\n            book = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findOne({\n                where: {\n                    id: req.params.id,\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            })\n\n            if(!book) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                    result: 'The requested book is not available now.'\n                }\n            }\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                json: book\n            }\n            \n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to get this book at the moment.',\n                error\n            }\n\n        }\n    }\n\n    async checkBookAvailability (id) {\n        try {\n\n            const existingBook = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findOne({\n                where: {\n                    id: id,\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n           \n            if (!existingBook) {\n               return false;\n            }\n \n            const availabilityStatus = existingBook.noOfBooksAvailable > 0 ? true : false;\n\n            return availabilityStatus;\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return 'ERROR';\n\n        }\n    }\n\n    async borrowBook (req) {\n\n        const bookId = req.body.bookId;\n        const memberId = req.body.memberId;\n       \n        const existingMember = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.findOne({\n            where: {\n                id: memberId,\n                unRegisteredYN: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.eq]: false }\n            }\n        });\n\n        if (!existingMember) {\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.FORBIDDEN,\n                result: `You must be a registered member to borrow this book. Please register first.`\n            }\n        }\n\n        if (existingMember.amountDue > 0) {\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.FORBIDDEN,\n                result: `Please pay your due amount ${existingMember.amountDue} to borrow this book.`\n            }\n        }\n       \n        const bookAvailability = await this.checkBookAvailability(bookId);\n        \n        if (bookAvailability === true) {\n\n            try {\n\n                const book = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findOne({\n                    where: {\n                        id: bookId,\n                        deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                    }\n                });\n\n                await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.update({\n                    noOfBooksAvailable: book.noOfBooksAvailable - 1\n                }, {\n                    where: {\n                        id: bookId\n                    }\n                });\n\n                await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.update({\n                    noOfBooksTaken: existingMember.noOfBooksTaken + 1\n                }, {\n                    where: {\n                        id: memberId\n                    }\n                });\n\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                    result: 'One copy of the requested book has been lent to you.'\n                }\n\n            }\n            catch (error) {\n\n                __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                    result: 'Unable to lend this book at the moment due to technical issues.',\n                    error\n                }\n\n            }\n        }\n        else if (bookAvailability === false) {\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                result: 'This book is not available at the moment.'\n            }\n        }\n        else {\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to lend this book at the moment due to technical issues.'\n            }\n        }\n    }\n\n    async returnBook (req) {\n\n        const bookId = req.body.bookId;\n        const memberId = req.body.memberId;\n\n        try {\n\n            const book = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findOne({\n                where: {\n                    id: bookId,\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n\n            const existingMember = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.findOne({\n                where: {\n                    id: memberId,\n                    unRegisteredYN: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n            \n            if (!existingMember) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.FORBIDDEN,\n                    result: `You must be a registered member to return a book. Please register first.`\n                }\n            }\n\n            if (!book) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.BAD_REQUEST,\n                    result: 'We did not lend you this book. Please check.'\n                }\n            }\n\n            await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.update({\n                noOfBooksAvailable: book.noOfBooksAvailable + 1\n            }, {\n                where: {\n                    id: bookId\n                }\n            });\n\n            await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.update({\n                noOfBooksTaken: existingMember.noOfBooksTaken - 1\n            }, {\n                where: {\n                    id: memberId\n                }\n            });\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                result: 'The return of your book has been accepted.'\n            }\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to accept this book at the moment due to technical issues.',\n                error\n            }\n\n        }\n    }\n\n    async updateBook (req) {\n\n        const { name = '', author = '', publishedDate = '', edition = '', shelfNumber = '' } = req.body;\n        // Instead of updating all the values, find the diff and update that alone.\n        let updatedBook;\n\n        Object(__WEBPACK_IMPORTED_MODULE_4__utils_util_js__[\"a\" /* validateBook */])(name, author, edition, publishedDate, shelfNumber);\n\n        try {\n\n            // Move the below query into a separate sub, as it is common for many subs.\n            const existingBook = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findOne({\n                where: {\n                    id: req.params.id,\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n\n            if (!existingBook) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                    result: 'The requested book is not available to be updated.'\n                }\n            }\n\n            await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.update({\n                name,\n                author,\n                edition,\n                shelfNumber,\n                publishedDate\n            }, {\n                where: {\n                    id: req.params.id\n                }\n            });\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                result: 'The properties of this book have been updated.'\n            }\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to update this book at the moment.',\n                error\n            }\n\n        }\n    }\n\n    async deleteBook (req) {\n\n        try {\n\n            const existingBook = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.findOne({\n                where: {\n                    id: req.params.id,\n                    deleted: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n\n            if (!existingBook) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                    result: 'The requested book is not available to be deleted.'\n                }\n            }\n\n            await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].book.update({\n              deleted: true\n            }, {\n                where: {\n                    id: req.params.id\n                }\n            });\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                result: 'The requested book has been marked as deleted in the library records.'\n            }\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to delete this book at the moment.',\n                error\n            }\n        }\n    }\n\n    async getBookAvailability (req) {\n       \n        const availability = await this.checkBookAvailability(req.params.id);\n\n        if (availability === 'ERROR') {\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to check availability at the moment.'\n            }\n        }\n        else {\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                json: { availability }\n            }\n        }\n    }\n};\n\nconst bookInstance = new Book();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (bookInstance);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbG9naWMvYm9vay5qcz85MzgzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTZXF1ZWxpemUgZnJvbSAnc2VxdWVsaXplJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vZGIvZGIuanMnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuLi9sb2dnZXIuanMnO1xuaW1wb3J0IEh0dHBTdGF0dXMgZnJvbSAnaHR0cC1zdGF0dXMtY29kZXMnO1xuaW1wb3J0IHsgdmFsaWRhdGVCb29rIH0gZnJvbSAnLi4vdXRpbHMvdXRpbC5qcyc7XG5cbmNsYXNzIEJvb2sge1xuXG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgICAvLyBOZWVkICd0aGlzJyB0byBiZSBkZWZpbmVkIHRvIGFjY2VzcyBjaGVja0Jvb2tBdmFpbGFiaWxpdHkgd2l0aGluIGJvcnJvd0Jvb2suXG4gICAgICAgIC8vIEFsbCBtZXRob2RzIHdlcmUgc3RhdGljIHByZXZpb3VzbHksIGJ1dCAndGhpcycgd2FzIHVuZGVmaW5lZCBpbnNpZGUgdGhvc2UgbWV0aG9kcyB3aGVuIHRoZSBtZXRob2RzIHdlcmUgcGFzc2VkIGFzIGFyZ3VtZW50cyB0byB0aGUgaGFuZGxlci5cblxuICAgICAgICB0aGlzLmJvcnJvd0Jvb2sgPSB0aGlzLmJvcnJvd0Jvb2suYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5jaGVja0Jvb2tBdmFpbGFiaWxpdHkgPSB0aGlzLmNoZWNrQm9va0F2YWlsYWJpbGl0eS5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGFzeW5jIGFkZEJvb2sgKHJlcSkge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgeyBuYW1lID0gJycsIGF1dGhvciA9ICcnLCBlZGl0aW9uID0gJycsIHB1Ymxpc2hlZERhdGUgPSAnJywgc2hlbGZOdW1iZXIgPSAnJyB9ID0gcmVxLmJvZHk7XG4gICAgICAgIGxldCBjcmVhdGVkQm9vaztcbiAgICAgICAgbGV0IGV4aXN0aW5nQm9vaztcblxuICAgICAgICB2YWxpZGF0ZUJvb2sobmFtZSwgYXV0aG9yLCBlZGl0aW9uLCBwdWJsaXNoZWREYXRlLCBzaGVsZk51bWJlcik7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBleGlzdGluZ0Jvb2sgPSBhd2FpdCBkYi5ib29rLmZpbmRBbGwoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQ6IHsgW1NlcXVlbGl6ZS5PcC5uZV06IHRydWUgfSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yLFxuICAgICAgICAgICAgICAgICAgICBlZGl0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChleGlzdGluZ0Jvb2subGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlZEJvb2sgPSBhd2FpdCBkYi5ib29rLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcixcbiAgICAgICAgICAgICAgICAgICAgZWRpdGlvbixcbiAgICAgICAgICAgICAgICAgICAgc2hlbGZOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHB1Ymxpc2hlZERhdGUsXG4gICAgICAgICAgICAgICAgICAgIG5vT2ZCb29rc0F2YWlsYWJsZTogMVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgIGF3YWl0IGRiLmJvb2sudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgbm9PZkJvb2tzQXZhaWxhYmxlOiBleGlzdGluZ0Jvb2tbMF0ubm9PZkJvb2tzQXZhaWxhYmxlICsgMVxuICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBleGlzdGluZ0Jvb2tbMF0uaWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgY3JlYXRlZEJvb2sgPSBleGlzdGluZ0Jvb2tbMF07XG4gICAgICAgICAgICAgICAgY3JlYXRlZEJvb2subm9PZkJvb2tzQXZhaWxhYmxlICs9IDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLkNSRUFURUQsXG4gICAgICAgICAgICAgICAgcmVzdWx0OiAnVGhpcyBib29rIGhhcyBiZWVuIGFkZGVkIHRvIG91ciBsaWJyYXJ5LidcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdVbmFibGUgdG8gY3JlYXRlIGJvb2tzIGF0IHRoZSBtb21lbnQuJyxcbiAgICAgICAgICAgICAgICBlcnJvclxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBnZXRBbGxCb29rcyAocmVxKSB7XG5cbiAgICAgICAgbGV0IGFsbEJvb2tzO1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBhbGxCb29rcyA9IGF3YWl0IGRiLmJvb2suZmluZEFsbCh7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlZDogeyBbU2VxdWVsaXplLk9wLm5lXTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgIGpzb246IGFsbEJvb2tzXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdVbmFibGUgdG8gZmV0Y2ggYm9va3MgYXQgdGhlIG1vbWVudC4nLFxuICAgICAgICAgICAgICAgIGVycm9yXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGdldEJvb2sgKHJlcSkge1xuXG4gICAgICAgIGxldCBib29rO1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBib29rID0gYXdhaXQgZGIuYm9vay5maW5kT25lKHtcbiAgICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICAgICBpZDogcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlZDogeyBbU2VxdWVsaXplLk9wLm5lXTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgaWYoIWJvb2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuT0ssXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSByZXF1ZXN0ZWQgYm9vayBpcyBub3QgYXZhaWxhYmxlIG5vdy4nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogSHR0cFN0YXR1cy5PSyxcbiAgICAgICAgICAgICAgICBqc29uOiBib29rXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdVbmFibGUgdG8gZ2V0IHRoaXMgYm9vayBhdCB0aGUgbW9tZW50LicsXG4gICAgICAgICAgICAgICAgZXJyb3JcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY2hlY2tCb29rQXZhaWxhYmlsaXR5IChpZCkge1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0Jvb2sgPSBhd2FpdCBkYi5ib29rLmZpbmRPbmUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlZDogeyBbU2VxdWVsaXplLk9wLm5lXTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCFleGlzdGluZ0Jvb2spIHtcbiAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiBcbiAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJpbGl0eVN0YXR1cyA9IGV4aXN0aW5nQm9vay5ub09mQm9va3NBdmFpbGFibGUgPiAwID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgICAgICByZXR1cm4gYXZhaWxhYmlsaXR5U3RhdHVzO1xuXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG5cbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gJ0VSUk9SJztcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgYm9ycm93Qm9vayAocmVxKSB7XG5cbiAgICAgICAgY29uc3QgYm9va0lkID0gcmVxLmJvZHkuYm9va0lkO1xuICAgICAgICBjb25zdCBtZW1iZXJJZCA9IHJlcS5ib2R5Lm1lbWJlcklkO1xuICAgICAgIFxuICAgICAgICBjb25zdCBleGlzdGluZ01lbWJlciA9IGF3YWl0IGRiLm1lbWJlci5maW5kT25lKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgaWQ6IG1lbWJlcklkLFxuICAgICAgICAgICAgICAgIHVuUmVnaXN0ZXJlZFlOOiB7IFtTZXF1ZWxpemUuT3AuZXFdOiBmYWxzZSB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghZXhpc3RpbmdNZW1iZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLkZPUkJJRERFTixcbiAgICAgICAgICAgICAgICByZXN1bHQ6IGBZb3UgbXVzdCBiZSBhIHJlZ2lzdGVyZWQgbWVtYmVyIHRvIGJvcnJvdyB0aGlzIGJvb2suIFBsZWFzZSByZWdpc3RlciBmaXJzdC5gXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXhpc3RpbmdNZW1iZXIuYW1vdW50RHVlID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuRk9SQklEREVOLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogYFBsZWFzZSBwYXkgeW91ciBkdWUgYW1vdW50ICR7ZXhpc3RpbmdNZW1iZXIuYW1vdW50RHVlfSB0byBib3Jyb3cgdGhpcyBib29rLmBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgIFxuICAgICAgICBjb25zdCBib29rQXZhaWxhYmlsaXR5ID0gYXdhaXQgdGhpcy5jaGVja0Jvb2tBdmFpbGFiaWxpdHkoYm9va0lkKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChib29rQXZhaWxhYmlsaXR5ID09PSB0cnVlKSB7XG5cbiAgICAgICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBib29rID0gYXdhaXQgZGIuYm9vay5maW5kT25lKHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBib29rSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVkOiB7IFtTZXF1ZWxpemUuT3AubmVdOiB0cnVlIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgYXdhaXQgZGIuYm9vay51cGRhdGUoe1xuICAgICAgICAgICAgICAgICAgICBub09mQm9va3NBdmFpbGFibGU6IGJvb2subm9PZkJvb2tzQXZhaWxhYmxlIC0gMVxuICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBib29rSWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgYXdhaXQgZGIubWVtYmVyLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG5vT2ZCb29rc1Rha2VuOiBleGlzdGluZ01lbWJlci5ub09mQm9va3NUYWtlbiArIDFcbiAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogbWVtYmVySWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6ICdPbmUgY29weSBvZiB0aGUgcmVxdWVzdGVkIGJvb2sgaGFzIGJlZW4gbGVudCB0byB5b3UuJ1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogSHR0cFN0YXR1cy5JTlRFUk5BTF9TRVJWRVJfRVJST1IsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogJ1VuYWJsZSB0byBsZW5kIHRoaXMgYm9vayBhdCB0aGUgbW9tZW50IGR1ZSB0byB0ZWNobmljYWwgaXNzdWVzLicsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYm9va0F2YWlsYWJpbGl0eSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoaXMgYm9vayBpcyBub3QgYXZhaWxhYmxlIGF0IHRoZSBtb21lbnQuJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuSU5URVJOQUxfU0VSVkVSX0VSUk9SLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1VuYWJsZSB0byBsZW5kIHRoaXMgYm9vayBhdCB0aGUgbW9tZW50IGR1ZSB0byB0ZWNobmljYWwgaXNzdWVzLidcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHJldHVybkJvb2sgKHJlcSkge1xuXG4gICAgICAgIGNvbnN0IGJvb2tJZCA9IHJlcS5ib2R5LmJvb2tJZDtcbiAgICAgICAgY29uc3QgbWVtYmVySWQgPSByZXEuYm9keS5tZW1iZXJJZDtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBjb25zdCBib29rID0gYXdhaXQgZGIuYm9vay5maW5kT25lKHtcbiAgICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICAgICBpZDogYm9va0lkLFxuICAgICAgICAgICAgICAgICAgICBkZWxldGVkOiB7IFtTZXF1ZWxpemUuT3AubmVdOiB0cnVlIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdNZW1iZXIgPSBhd2FpdCBkYi5tZW1iZXIuZmluZE9uZSh7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IG1lbWJlcklkLFxuICAgICAgICAgICAgICAgICAgICB1blJlZ2lzdGVyZWRZTjogeyBbU2VxdWVsaXplLk9wLm5lXTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghZXhpc3RpbmdNZW1iZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuRk9SQklEREVOLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IGBZb3UgbXVzdCBiZSBhIHJlZ2lzdGVyZWQgbWVtYmVyIHRvIHJldHVybiBhIGJvb2suIFBsZWFzZSByZWdpc3RlciBmaXJzdC5gXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWJvb2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuQkFEX1JFUVVFU1QsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogJ1dlIGRpZCBub3QgbGVuZCB5b3UgdGhpcyBib29rLiBQbGVhc2UgY2hlY2suJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgZGIuYm9vay51cGRhdGUoe1xuICAgICAgICAgICAgICAgIG5vT2ZCb29rc0F2YWlsYWJsZTogYm9vay5ub09mQm9va3NBdmFpbGFibGUgKyAxXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGJvb2tJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhd2FpdCBkYi5tZW1iZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgICBub09mQm9va3NUYWtlbjogZXhpc3RpbmdNZW1iZXIubm9PZkJvb2tzVGFrZW4gLSAxXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IG1lbWJlcklkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSByZXR1cm4gb2YgeW91ciBib29rIGhhcyBiZWVuIGFjY2VwdGVkLidcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuSU5URVJOQUxfU0VSVkVSX0VSUk9SLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1VuYWJsZSB0byBhY2NlcHQgdGhpcyBib29rIGF0IHRoZSBtb21lbnQgZHVlIHRvIHRlY2huaWNhbCBpc3N1ZXMuJyxcbiAgICAgICAgICAgICAgICBlcnJvclxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVCb29rIChyZXEpIHtcblxuICAgICAgICBjb25zdCB7IG5hbWUgPSAnJywgYXV0aG9yID0gJycsIHB1Ymxpc2hlZERhdGUgPSAnJywgZWRpdGlvbiA9ICcnLCBzaGVsZk51bWJlciA9ICcnIH0gPSByZXEuYm9keTtcbiAgICAgICAgLy8gSW5zdGVhZCBvZiB1cGRhdGluZyBhbGwgdGhlIHZhbHVlcywgZmluZCB0aGUgZGlmZiBhbmQgdXBkYXRlIHRoYXQgYWxvbmUuXG4gICAgICAgIGxldCB1cGRhdGVkQm9vaztcblxuICAgICAgICB2YWxpZGF0ZUJvb2sobmFtZSwgYXV0aG9yLCBlZGl0aW9uLCBwdWJsaXNoZWREYXRlLCBzaGVsZk51bWJlcik7XG5cbiAgICAgICAgdHJ5IHtcblxuICAgICAgICAgICAgLy8gTW92ZSB0aGUgYmVsb3cgcXVlcnkgaW50byBhIHNlcGFyYXRlIHN1YiwgYXMgaXQgaXMgY29tbW9uIGZvciBtYW55IHN1YnMuXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0Jvb2sgPSBhd2FpdCBkYi5ib29rLmZpbmRPbmUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiByZXEucGFyYW1zLmlkLFxuICAgICAgICAgICAgICAgICAgICBkZWxldGVkOiB7IFtTZXF1ZWxpemUuT3AubmVdOiB0cnVlIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFleGlzdGluZ0Jvb2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuT0ssXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSByZXF1ZXN0ZWQgYm9vayBpcyBub3QgYXZhaWxhYmxlIHRvIGJlIHVwZGF0ZWQuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXdhaXQgZGIuYm9vay51cGRhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgYXV0aG9yLFxuICAgICAgICAgICAgICAgIGVkaXRpb24sXG4gICAgICAgICAgICAgICAgc2hlbGZOdW1iZXIsXG4gICAgICAgICAgICAgICAgcHVibGlzaGVkRGF0ZVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiByZXEucGFyYW1zLmlkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSBwcm9wZXJ0aWVzIG9mIHRoaXMgYm9vayBoYXZlIGJlZW4gdXBkYXRlZC4nXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdVbmFibGUgdG8gdXBkYXRlIHRoaXMgYm9vayBhdCB0aGUgbW9tZW50LicsXG4gICAgICAgICAgICAgICAgZXJyb3JcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZGVsZXRlQm9vayAocmVxKSB7XG5cbiAgICAgICAgdHJ5IHtcblxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdCb29rID0gYXdhaXQgZGIuYm9vay5maW5kT25lKHtcbiAgICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICAgICBpZDogcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlZDogeyBbU2VxdWVsaXplLk9wLm5lXTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghZXhpc3RpbmdCb29rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6ICdUaGUgcmVxdWVzdGVkIGJvb2sgaXMgbm90IGF2YWlsYWJsZSB0byBiZSBkZWxldGVkLidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IGRiLmJvb2sudXBkYXRlKHtcbiAgICAgICAgICAgICAgZGVsZXRlZDogdHJ1ZVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiByZXEucGFyYW1zLmlkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSByZXF1ZXN0ZWQgYm9vayBoYXMgYmVlbiBtYXJrZWQgYXMgZGVsZXRlZCBpbiB0aGUgbGlicmFyeSByZWNvcmRzLidcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuSU5URVJOQUxfU0VSVkVSX0VSUk9SLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1VuYWJsZSB0byBkZWxldGUgdGhpcyBib29rIGF0IHRoZSBtb21lbnQuJyxcbiAgICAgICAgICAgICAgICBlcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0Qm9va0F2YWlsYWJpbGl0eSAocmVxKSB7XG4gICAgICAgXG4gICAgICAgIGNvbnN0IGF2YWlsYWJpbGl0eSA9IGF3YWl0IHRoaXMuY2hlY2tCb29rQXZhaWxhYmlsaXR5KHJlcS5wYXJhbXMuaWQpO1xuXG4gICAgICAgIGlmIChhdmFpbGFiaWxpdHkgPT09ICdFUlJPUicpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdVbmFibGUgdG8gY2hlY2sgYXZhaWxhYmlsaXR5IGF0IHRoZSBtb21lbnQuJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuT0ssXG4gICAgICAgICAgICAgICAganNvbjogeyBhdmFpbGFiaWxpdHkgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxuY29uc3QgYm9va0luc3RhbmNlID0gbmV3IEJvb2soKTtcblxuZXhwb3J0IGRlZmF1bHQgYm9va0luc3RhbmNlO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4uL2xvZ2ljL2Jvb2suanNcbi8vIG1vZHVsZSBpZCA9IDE1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///15\n");

/***/ }),
/* 16 */
/*!****************************!*\
  !*** external "validator" ***!
  \****************************/
/*! dynamic exports provided */
/*! exports used: default */
/***/ (function(module, exports) {

eval("module.exports = require(\"validator\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ2YWxpZGF0b3JcIj81NGQxIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInZhbGlkYXRvclwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInZhbGlkYXRvclwiXG4vLyBtb2R1bGUgaWQgPSAxNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///16\n");

/***/ }),
/* 17 */
/*!******************************************!*\
  !*** ../controllers/memberController.js ***!
  \******************************************/
/*! exports provided: memberRouter */
/*! exports used: memberRouter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_express__ = __webpack_require__(/*! express */ 2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_express___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_express__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__ = __webpack_require__(/*! ../middleware/handlers.js */ 5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__logic_member_js__ = __webpack_require__(/*! ../logic/member.js */ 18);\n\n\n\n\nconst memberRouter = () => {\n\n    const memberRouter = __WEBPACK_IMPORTED_MODULE_0_express___default.a.Router();\n\n    memberRouter.post   ('/members',     async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_member_js__[\"a\" /* default */].registerMember));\n    memberRouter.delete ('/members/:id', async (req, res) => Object(__WEBPACK_IMPORTED_MODULE_1__middleware_handlers_js__[\"a\" /* requestHandler */])(req, res, __WEBPACK_IMPORTED_MODULE_2__logic_member_js__[\"a\" /* default */].unRegisterMember));\n\n    return memberRouter;\n};\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = memberRouter;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vY29udHJvbGxlcnMvbWVtYmVyQ29udHJvbGxlci5qcz84NjlkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgcmVxdWVzdEhhbmRsZXIgfSBmcm9tICcuLi9taWRkbGV3YXJlL2hhbmRsZXJzLmpzJztcbmltcG9ydCBNZW1iZXJGdW5jdGlvbnMgZnJvbSAnLi4vbG9naWMvbWVtYmVyLmpzJztcblxuZXhwb3J0IGNvbnN0IG1lbWJlclJvdXRlciA9ICgpID0+IHtcblxuICAgIGNvbnN0IG1lbWJlclJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbiAgICBtZW1iZXJSb3V0ZXIucG9zdCAgICgnL21lbWJlcnMnLCAgICAgYXN5bmMgKHJlcSwgcmVzKSA9PiByZXF1ZXN0SGFuZGxlcihyZXEsIHJlcywgTWVtYmVyRnVuY3Rpb25zLnJlZ2lzdGVyTWVtYmVyKSk7XG4gICAgbWVtYmVyUm91dGVyLmRlbGV0ZSAoJy9tZW1iZXJzLzppZCcsIGFzeW5jIChyZXEsIHJlcykgPT4gcmVxdWVzdEhhbmRsZXIocmVxLCByZXMsIE1lbWJlckZ1bmN0aW9ucy51blJlZ2lzdGVyTWVtYmVyKSk7XG5cbiAgICByZXR1cm4gbWVtYmVyUm91dGVyO1xufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuLi9jb250cm9sbGVycy9tZW1iZXJDb250cm9sbGVyLmpzXG4vLyBtb2R1bGUgaWQgPSAxN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///17\n");

/***/ }),
/* 18 */
/*!**************************!*\
  !*** ../logic/member.js ***!
  \**************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize__ = __webpack_require__(/*! sequelize */ 1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_sequelize___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_sequelize__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__db_db_js__ = __webpack_require__(/*! ../db/db.js */ 3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__logger_js__ = __webpack_require__(/*! ../logger.js */ 0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_http_status_codes__ = __webpack_require__(/*! http-status-codes */ 6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_http_status_codes__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_util_js__ = __webpack_require__(/*! ../utils/util.js */ 7);\n\n\n\n\n\n\nclass Member {\n\n    static async registerMember (req) {\n\n        const { username = '', contactNumber = '' } = req.body;\n        let createdUser;\n        let existingMember;\n\n        Object(__WEBPACK_IMPORTED_MODULE_4__utils_util_js__[\"b\" /* validateMember */])(username, contactNumber);\n\n        try {\n\n            existingMember = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.findOne({\n                where: {\n                    username,\n                    unRegisteredYN: { [__WEBPACK_IMPORTED_MODULE_0_sequelize___default.a.Op.ne]: true }\n                }\n            });\n\n            if (existingMember) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.BAD_REQUEST,\n                    result: 'The requested user is already a registered member.'\n                }\n            }\n\n            createdUser = await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.create({\n                username,\n                contactNumber\n            });\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.CREATED,\n                result: 'The requested user has been registered.'\n            }\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to register this user at the moment.',\n                error\n            }\n\n        }\n    }\n\n    static async unRegisterMember (req) {\n        const memberId = req.params.id;\n\n        try {\n\n            const existingMember = __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.findOne({\n                where: { \n                    id: memberId\n                }\n            });\n\n            if (!existingMember) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.BAD_REQUEST,\n                    result: 'This user is not already registered with us.'\n                }\n            }\n\n            if (existingMember.unRegisteredYN) {\n                return {\n                    status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                    result: 'This user has already unregsitered with us.'\n                }\n            };\n\n            await __WEBPACK_IMPORTED_MODULE_1__db_db_js__[\"a\" /* db */].member.update({\n                unRegisteredYN: true\n            }, {\n                where: {\n                    id: memberId\n                }\n            });\n\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.OK,\n                result: 'The requested user has been unregistered.'\n            }\n\n        }\n        catch (error) {\n\n            __WEBPACK_IMPORTED_MODULE_2__logger_js__[\"a\" /* default */].error(error);\n            return {\n                status: __WEBPACK_IMPORTED_MODULE_3_http_status_codes___default.a.INTERNAL_SERVER_ERROR,\n                result: 'Unable to unregister this user at the moment.',\n                error\n            }\n\n        }\n    }\n\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = Member;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbG9naWMvbWVtYmVyLmpzP2JkM2QiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNlcXVlbGl6ZSBmcm9tICdzZXF1ZWxpemUnO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi9kYi9kYi5qcyc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4uL2xvZ2dlci5qcyc7XG5pbXBvcnQgSHR0cFN0YXR1cyBmcm9tICdodHRwLXN0YXR1cy1jb2Rlcyc7XG5pbXBvcnQgeyB2YWxpZGF0ZU1lbWJlciB9IGZyb20gJy4uL3V0aWxzL3V0aWwuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZW1iZXIge1xuXG4gICAgc3RhdGljIGFzeW5jIHJlZ2lzdGVyTWVtYmVyIChyZXEpIHtcblxuICAgICAgICBjb25zdCB7IHVzZXJuYW1lID0gJycsIGNvbnRhY3ROdW1iZXIgPSAnJyB9ID0gcmVxLmJvZHk7XG4gICAgICAgIGxldCBjcmVhdGVkVXNlcjtcbiAgICAgICAgbGV0IGV4aXN0aW5nTWVtYmVyO1xuXG4gICAgICAgIHZhbGlkYXRlTWVtYmVyKHVzZXJuYW1lLCBjb250YWN0TnVtYmVyKTtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBleGlzdGluZ01lbWJlciA9IGF3YWl0IGRiLm1lbWJlci5maW5kT25lKHtcbiAgICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICAgICB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdW5SZWdpc3RlcmVkWU46IHsgW1NlcXVlbGl6ZS5PcC5uZV06IHRydWUgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdNZW1iZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuQkFEX1JFUVVFU1QsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSByZXF1ZXN0ZWQgdXNlciBpcyBhbHJlYWR5IGEgcmVnaXN0ZXJlZCBtZW1iZXIuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3JlYXRlZFVzZXIgPSBhd2FpdCBkYi5tZW1iZXIuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICBjb250YWN0TnVtYmVyXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuQ1JFQVRFRCxcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdUaGUgcmVxdWVzdGVkIHVzZXIgaGFzIGJlZW4gcmVnaXN0ZXJlZC4nXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgICAgICAgICAgICByZXN1bHQ6ICdVbmFibGUgdG8gcmVnaXN0ZXIgdGhpcyB1c2VyIGF0IHRoZSBtb21lbnQuJyxcbiAgICAgICAgICAgICAgICBlcnJvclxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgYXN5bmMgdW5SZWdpc3Rlck1lbWJlciAocmVxKSB7XG4gICAgICAgIGNvbnN0IG1lbWJlcklkID0gcmVxLnBhcmFtcy5pZDtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ01lbWJlciA9IGRiLm1lbWJlci5maW5kT25lKHtcbiAgICAgICAgICAgICAgICB3aGVyZTogeyBcbiAgICAgICAgICAgICAgICAgICAgaWQ6IG1lbWJlcklkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghZXhpc3RpbmdNZW1iZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IEh0dHBTdGF0dXMuQkFEX1JFUVVFU1QsXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoaXMgdXNlciBpcyBub3QgYWxyZWFkeSByZWdpc3RlcmVkIHdpdGggdXMuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGV4aXN0aW5nTWVtYmVyLnVuUmVnaXN0ZXJlZFlOKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6ICdUaGlzIHVzZXIgaGFzIGFscmVhZHkgdW5yZWdzaXRlcmVkIHdpdGggdXMuJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGF3YWl0IGRiLm1lbWJlci51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHVuUmVnaXN0ZXJlZFlOOiB0cnVlXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IG1lbWJlcklkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBIdHRwU3RhdHVzLk9LLFxuICAgICAgICAgICAgICAgIHJlc3VsdDogJ1RoZSByZXF1ZXN0ZWQgdXNlciBoYXMgYmVlbiB1bnJlZ2lzdGVyZWQuJ1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG5cbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogSHR0cFN0YXR1cy5JTlRFUk5BTF9TRVJWRVJfRVJST1IsXG4gICAgICAgICAgICAgICAgcmVzdWx0OiAnVW5hYmxlIHRvIHVucmVnaXN0ZXIgdGhpcyB1c2VyIGF0IHRoZSBtb21lbnQuJyxcbiAgICAgICAgICAgICAgICBlcnJvclxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuLi9sb2dpYy9tZW1iZXIuanNcbi8vIG1vZHVsZSBpZCA9IDE4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///18\n");

/***/ })
/******/ ]);